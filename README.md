Adaption from [pmbm](https://github.com/erikbohnsack/pmbm)
